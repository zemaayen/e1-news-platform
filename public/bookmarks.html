<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Bookmarks - E1 News</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Ccircle cx='100' cy='100' r='100' fill='%23e30613'/%3E%3Ctext x='100' y='140' font-family='Times New Roman,serif' font-size='120' font-weight='900' fill='white' text-anchor='middle' letter-spacing='-5'%3EE1%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="top-bar-left">
                <div class="datetime-display">
                    <span id="currentDate"></span>
                    <span class="separator">|</span>
                    <span id="currentTime"></span>
                </div>
            </div>
            <div class="top-bar-right">
                <div id="userInfo"></div>
                <div class="language-switcher">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="am">·ä†·àõ</button>
                    <button class="lang-btn" data-lang="he">◊¢◊ë</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <a href="/" class="nav-brand">
                <div class="logo-wrapper">
                    <div class="logo-main">
                        <span class="logo-text">E1</span>
                    </div>
                    <span class="logo-subtitle">NEWS</span>
                </div>
            </a>
            <ul class="nav-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/bookmarks.html" class="active">My Bookmarks</a></li>
                <li><a href="/profile.html">Profile</a></li>
            </ul>
            
            <!-- Hamburger Menu Button (Mobile Only) -->
            <button class="hamburger-menu" id="hamburgerBtn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>
    
    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay" onclick="toggleMobileMenu()"></div>
    
    <!-- Mobile Navigation Menu -->
    <div class="mobile-nav-menu" id="mobileNavMenu">
        <!-- Mobile Menu Links -->
        <a href="/">üè† Home</a>
        <a href="/bookmarks.html" class="active">üîñ My Bookmarks</a>
        <a href="/profile.html">üë§ Profile</a>
        
        <!-- Divider -->
        <div style="height: 1px; background: #e5e5e5; margin: 20px 0;"></div>
        
        <!-- Social Media Links in Mobile Menu -->
        <div class="mobile-social-section">
            <h4 style="margin: 0 0 8px 0; padding: 0 20px; color: #666; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; font-weight: 700;">Follow Us</h4>
            <div class="mobile-social-links">
                <a href="https://www.tiktok.com/@yourchannel" target="_blank" rel="noopener noreferrer" class="mobile-social-item">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/>
                    </svg>
                    <span>TikTok</span>
                </a>
                <a href="https://www.instagram.com/yourprofile" target="_blank" rel="noopener noreferrer" class="mobile-social-item">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                    </svg>
                    <span>Instagram</span>
                </a>
                <a href="https://www.youtube.com/@yourchannel" target="_blank" rel="noopener noreferrer" class="mobile-social-item">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                    <span>YouTube</span>
                </a>
                <a href="https://twitter.com/yourhandle" target="_blank" rel="noopener noreferrer" class="mobile-social-item">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                    </svg>
                    <span>Twitter</span>
                </a>
            </div>
        </div>
        
        <!-- Divider -->
        <div style="height: 1px; background: #e5e5e5; margin: 20px 0;"></div>
        
        <!-- Language Switcher in Mobile Menu -->
        <div class="mobile-language-section">
            <h4 style="margin: 0 0 8px 0; padding: 0 20px; color: #666; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; font-weight: 700;">Language</h4>
            <div class="mobile-language-buttons">
                <button class="mobile-lang-btn active" data-lang="en" onclick="switchLanguage('en')" title="English">
                    <span class="flag">üá¨üáß</span>
                    <span class="lang-name">English</span>
                </button>
                <button class="mobile-lang-btn" data-lang="am" onclick="switchLanguage('am')" title="·ä†·àõ·à≠·äõ">
                    <span class="flag">üá™üáπ</span>
                    <span class="lang-name">·ä†·àõ·à≠·äõ</span>
                </button>
                <button class="mobile-lang-btn" data-lang="he" onclick="switchLanguage('he')" title="◊¢◊ë◊®◊ô◊™">
                    <span class="flag">üáÆüá±</span>
                    <span class="lang-name">◊¢◊ë◊®◊ô◊™</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Bookmarks Container -->
    <div class="bookmarks-container">
        <div class="bookmarks-header">
            <h1>
                üîñ My Bookmarks
                <span class="bookmarks-count" id="bookmarkCount">0 articles</span>
            </h1>
            <p style="color: var(--text-secondary); font-size: 1.1rem; margin-top: 10px;">
                Your saved articles for later reading
            </p>
        </div>

        <div id="bookmarksContent">
            <!-- Bookmarks will be loaded here -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2025 <span id="footerSiteName">E1</span>. All rights reserved.</p>
                <p>Your trusted source for news</p>
            </div>
        </div>
    </footer>

    <script>
        // ========== MOBILE MENU FUNCTIONS ==========
        
        // Toggle Mobile Navigation Menu
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileNavMenu');
            const overlay = document.getElementById('mobileNavOverlay');
            const hamburger = document.getElementById('hamburgerBtn');
            
            if (mobileMenu && overlay && hamburger) {
                mobileMenu.classList.toggle('active');
                overlay.classList.toggle('active');
                hamburger.classList.toggle('active');
                
                // Prevent body scroll when menu is open
                if (mobileMenu.classList.contains('active')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = '';
                }
            }
        }
        
        // Switch language from mobile menu
        function switchLanguage(lang) {
            // Update mobile menu buttons
            const mobileLangButtons = document.querySelectorAll('.mobile-lang-btn');
            mobileLangButtons.forEach(btn => {
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Store preference
            localStorage.setItem('preferredLanguage', lang);
            
            // Update page direction for Hebrew
            if (lang === 'he') {
                document.body.setAttribute('dir', 'rtl');
            } else {
                document.body.setAttribute('dir', 'ltr');
            }
        }
        
        // Close mobile menu on window resize if it's open
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                const mobileMenu = document.getElementById('mobileNavMenu');
                const overlay = document.getElementById('mobileNavOverlay');
                const hamburger = document.getElementById('hamburgerBtn');
                
                if (mobileMenu && mobileMenu.classList.contains('active')) {
                    mobileMenu.classList.remove('active');
                    overlay.classList.remove('active');
                    hamburger.classList.remove('active');
                    document.body.style.overflow = '';
                }
            }
        });
        
        // ========== AUTHENTICATION CHECK ==========
        
        // Check authentication
        const token = localStorage.getItem('token');
        if (!token) {
            alert('Please login to view your bookmarks');
            window.location.href = '/login.html';
        }

        // Date and Time Display
        function updateDateTime() {
            const now = new Date();
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', dateOptions);
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
        }
        updateDateTime();
        setInterval(updateDateTime, 1000);

        // Load user info
        async function loadUserInfo() {
            try {
                const response = await fetch('/api/profile', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const userInfo = document.getElementById('userInfo');
                    userInfo.innerHTML = `
                        <span style="color: white; margin-right: 10px;">üë§ ${data.user.fullName || data.user.username}</span>
                        <button onclick="logout()" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 5px 15px; border-radius: 5px; cursor: pointer;">Logout</button>
                    `;
                }
            } catch (error) {
                console.error('Error loading user info:', error);
            }
        }

        // Logout function
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('userRole');
            window.location.href = '/login.html';
        }

        // Load bookmarks
        async function loadBookmarks() {
            try {
                const response = await fetch('/api/bookmarks', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to load bookmarks');
                }
                
                const data = await response.json();
                const bookmarks = data.bookmarks;
                
                // Update count
                document.getElementById('bookmarkCount').textContent = 
                    `${bookmarks.length} ${bookmarks.length === 1 ? 'article' : 'articles'}`;
                
                const container = document.getElementById('bookmarksContent');
                
                if (bookmarks.length === 0) {
                    container.innerHTML = `
                        <div class="no-bookmarks">
                            <div class="no-bookmarks-icon">üìö</div>
                            <h3>No bookmarks yet</h3>
                            <p>Start bookmarking articles you want to read later!</p>
                            <a href="/" style="display: inline-block; margin-top: 20px; padding: 12px 30px; background: var(--n12-red); color: white; text-decoration: none; border-radius: 25px; font-weight: 600;">
                                Browse Articles
                            </a>
                        </div>
                    `;
                    return;
                }
                
                // Render bookmarked articles
                const bookmarksHTML = `
                    <div class="bookmarks-grid">
                        ${bookmarks.map(bookmark => {
                            const article = bookmark.article;
                            const savedDate = new Date(bookmark.createdAt).toLocaleDateString('en-US', {
                                year: 'numeric',
                                month: 'short',
                                day: 'numeric'
                            });
                            
                            return `
                                <div class="article-card" style="position: relative;">
                                    <button class="bookmark-btn bookmarked" onclick="removeBookmark(event, ${article.id})" title="Remove bookmark">
                                        <svg viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2">
                                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
                                        </svg>
                                    </button>
                                    <div onclick="viewArticle(${article.id})" style="cursor: pointer;">
                                        ${article.imageUrl ? `<img src="${article.imageUrl}" alt="${article.title}">` : ''}
                                        <div class="article-card-content">
                                            <span class="article-category">${article.category}</span>
                                            <h3>${article.title}</h3>
                                            <p>${article.content.substring(0, 150)}...</p>
                                            <div class="article-meta">
                                                <span>üìÖ Saved: ${savedDate}</span>
                                                <span>üëÅÔ∏è ${article.views} views</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                
                container.innerHTML = bookmarksHTML;
            } catch (error) {
                console.error('Error loading bookmarks:', error);
                document.getElementById('bookmarksContent').innerHTML = `
                    <div class="no-bookmarks">
                        <div class="no-bookmarks-icon">‚ö†Ô∏è</div>
                        <h3>Error loading bookmarks</h3>
                        <p>Please try again later</p>
                    </div>
                `;
            }
        }

        // Remove bookmark
        async function removeBookmark(event, articleId) {
            event.stopPropagation();
            
            if (!confirm('Remove this article from bookmarks?')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/bookmarks/${articleId}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    // Reload bookmarks
                    loadBookmarks();
                    showToast('Bookmark removed', 'success');
                } else {
                    throw new Error('Failed to remove bookmark');
                }
            } catch (error) {
                console.error('Error removing bookmark:', error);
                showToast('Error removing bookmark', 'error');
            }
        }

        // View article
        function viewArticle(id) {
            window.location.href = `/article.html?id=${id}`;
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.style.cssText = `
                position: fixed;
                bottom: 30px;
                right: 30px;
                background: ${type === 'success' ? '#28a745' : '#dc3545'};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                animation: slideInUp 0.3s ease;
                font-weight: 500;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutDown 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 2000);
        }

        // Load site settings
        async function loadSiteSettings() {
            try {
                const response = await fetch('/api/settings');
                const data = await response.json();
                const settings = data.settings;
                
                const siteName = settings.siteName || 'E1';
                document.title = `My Bookmarks - ${siteName} News`;
                
                const footerSiteName = document.getElementById('footerSiteName');
                if (footerSiteName) {
                    footerSiteName.textContent = siteName;
                }
            } catch (error) {
                console.error('Error loading site settings:', error);
            }
        }

        // Initialize page
        loadUserInfo();
        loadBookmarks();
        loadSiteSettings();
        
        // Add animations CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInUp {
                from { transform: translateY(100%); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            @keyframes slideOutDown {
                from { transform: translateY(0); opacity: 1; }
                to { transform: translateY(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>

